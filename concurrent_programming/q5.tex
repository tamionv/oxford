I assume \texttt{doDebit} is the second code listing shown. The problem appears in the following kind of situation: suppose initially our balance is 1. We then simultaneously debit 1 twice in two different threads. The threads may interleave themselves in such a way that both threads check if the account can debit before any one of them actually debits the account. They would then both debit the account by one unit. This would leave us with an overdrawn account, which was not expected (implicitly, I assume that we want to maintain a safety condition that guarantees a non-negative balance at all times). A way to fix this would be to make \texttt{doDebit} atomic as well. This would not allow the \texttt{canDebit} check to be separated from the call of \texttt{debit} in any potential interleaving, thus insuring that only valid \texttt{debit}'s are done.

